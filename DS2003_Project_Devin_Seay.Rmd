---
title: "DS2003Midterm"
output: html_document
date: "2022-10-03"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(tidyverse)
```


```{r cars}
library(corrr)
install.packages("corrplot")
library(corrplot)
Grades <- read_csv("D:/DS_2003/DS-2003/student-mat.csv")
view(Grades)
Grades[,c(1,2,4,5,6,9,10,11,12,16,17,18,19,20,21,22,23)] <- lapply(Grades[,c(1,2,4,5,6,9,10,11,12,16,17,18,19,20,21,22,23)], as.factor)
str(Grades)

Grades[] <- lapply(Grades, as.integer)
view(Grades)
Grades_cor <- cor(Grades[1:30], Grades[31:33])
Grades_cor <- Grades_cor[order(Grades_cor[1:30]),]
Grades_cor <- as.data.frame(Grades_cor)
Grades_cor["rownames"] <- rownames(Grades_cor)
Grades_cor
Grades_cor %>%
  ggplot(aes(x = rownames, y = G1)) + 
  geom_bar(size =4, stat = "identity") +
  ylab("Correlation with G1") +
  xlab("Variable") +
  theme(text = element_text(size=10), axis.text.x = element_text(angle=90, hjust=1))

```
